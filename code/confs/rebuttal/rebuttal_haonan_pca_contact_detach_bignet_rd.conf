train{
    # folder structure: exps_folder/subject/methodname/train_split/train/[checkpoints, saved conf]
    #                                                             /eval/test_split/step/image_folders
    exps_folder = ../data/experiments # location of experiments folder, use ln -s to link to data disk
    methodname = IMavatar_rebuttal_haonan2hands_rd_pca_10_50000_depth1_continue_single_continue #_small #_trainsample2_continue_10_500000  #_depth50 #_noflamedist #_transformation #_rotate180
    dataset_class = datasets.real_dataset_rd_2hands.FaceDataset
    model_class = model.implicit_morphable_model_metahuman_pca_contact_detach_bignet_rd_2hands.IMavatar
    loss_class = model.loss_metahuman_pca_detach_rd_2hands.Loss
    learning_rate = 1.0e-4
    learning_rate_cam = 1.0e-4
    learning_rate_nonrigid = 1.0e-4
    num_pixels = 1024
    batch_size = 1
    plot_freq = 1
    alpha_milestones = []
    alpha_factor = 2
    sched_milestones = [400, 800]
    sched_factor = 0.5
    optimize_latent_code=True
    optimize_expression=False
    optimize_camera=False
    optimize_contact=True
    optimize_pca=True
    train_script=train_detach_rd_2hands
    test_script=test_2hands
    contact_only=False
    optimize_mano_pose=False
}
plot{
    plot_nimgs =2
    max_depth = 6.0
    min_depth = 3.0
    res_init = 32
    res_up = 3
}
loss{
    mask_weight = 100.0
    depth_weight = 1
    lbs_weight = 0.01
    flame_distance_weight = 10000.0
    alpha = 50.0
    gt_w_seg=True
    expression_reg_weight = 0.0
    pose_reg_weight = 0.0
    cam_reg_weight = 0.0
    eikonal_weight = 0.1
}
dataset{
    data_folder = /home/haonan/data/IMavatar_iccv/data/datasets
    subject_name = rebuttal/haonan_2hands
    json_name = mano_flame_params_rd.json
    train{
        sub_dir = [rgb] # in main paper, we used [MVI_1810, MVI_1811]
        img_res = [256, 256]
        subsample = 1
    }
    test{
        sub_dir = [rgb]
        img_res = [256, 256]
        subsample=  32
    }
}
model{
    feature_vector_size = 256
    geometry_network
    {
        d_in = 3
        condition_in=0,
        d_out = 1
        dims = [ 512, 512, 512, 512, 512, 512, 512, 512 ]
        geometric_init = True
        bias = 0.6
        skip_in = [4]
        weight_norm = True
        multires = 6
    }
    rendering_network
    {
        d_in = 6
        bottleneck = 8
        condition_in = 53
        d_out = 3
        dims = [ 512, 512, 512, 512]
        weight_norm = True
        multires_view = 0
        multires_pnts = 4
    }
    ray_tracer
    {
        object_bounding_sphere = 1.2
        sdf_threshold = 5.0e-5
        line_search_step = 0.5
        line_step_iters = 3
        sphere_tracing_iters = 10
        n_steps = 100
        n_secant_steps = 8
        use_sphere_tracing = False
    }
    deformer_class = model.implicit_morphable_model_metahuman_pca_contact_detach_bignet_rd.BackwardDeformer
    deformer_network
    {
        d_in = 3
        d_out = 263
        condition_in = 56
        dims = [128, 128, 128, 128]
        geometric_init = True
        weight_norm = True
        multires = 0
        num_exp = 50
	    ghostbone = False
    }
    deformer_class_nonrigid = model.implicit_morphable_model_metahuman_pca_contact_detach_bignet_rd.NonrigidDeformer
    nonrigid_deformer_network
    {
        d_in = 3
        d_out = 90
        condition_in = 56
        dims = [512, 512, 512, 512]
        weight_norm = True
        multires = 4
    }
}
